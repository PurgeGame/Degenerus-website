(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function e(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(o){if(o.ep)return;o.ep=!0;const a=e(o);fetch(o.href,a)}})();const it=[10,10,10,10,9,9,9,8],$t=75,Bt=["pink","purple","green","red","blue","orange","silver","gold"],Pe=["Pink","Purple","Green","Red","Blue","Orange","Silver","Gold"],ce=["crypto","zodiac","cards","dice"],xe={crypto:["xrp","tron","sui","monero","solana","chainlink","ethereum","bitcoin"],zodiac:["aries","taurus","gemini","cancer","leo","libra","sagittarius","aquarius"],cards:["club","diamond","heart","spade","horseshoe","cashsack","king","ace"],dice:["1","2","3","4","5","6","7","8"]},Ne={crypto:["WWXRP","Tron","Sui","Monero","Solana","Chainlink","Ethereum","Bitcoin"],zodiac:["Aries","Taurus","Gemini","Cancer","Leo","Libra","Sagittarius","Aquarius"],cards:["Club","Diamond","Heart","Spade","Horseshoe","Cashsack","King","Ace"],dice:["1","2","3","4","5","6","7","8"]},Ae=[3,4,5,6,0,2,1,7];function Oe(t,n){return t==="cards"?Ae[n]??n:n}function re(t,n,e){const s=ce[t],o=Oe(s,n),a=xe[s][n],i=Bt[e];return`/badges-circular/${s}_0${o}_${a}_${i}.svg`}const le=0,De=1,qe=2,He=3,Et=["None","ETH","BURNIE","DGNRS"],Fe=0,kt=3,J=["ETH","BURNIE","DGNRS","WWXRP"],Wt=[0,0,189,500,1778,6667,31111,155556,355556],ue=11111111,bt=444,v={MIN_SCORE:0,MID_SCORE:7500,HIGH_SCORE:25500,MAX_SCORE:35500},$={MIN:9e3,MID:9500,HIGH:9950,MAX:9990},Ue=500,ht=9e3,Gt=10990,We=1e6,Ge=144136,Xe=900848,Ve=4206141,je=97914359,Ke=344701627,Ye=869087,ze=1e6,I={LEVEL_STREAK_MAX:50,LEVEL_STREAK_BPS:100,MINT_COUNT_MAX:25,MINT_COUNT_BPS:100,QUEST_STREAK_MAX:100,QUEST_STREAK_BPS:100,AFFILIATE_BPS:100,TROPHY_MAX:5,TROPHY_BPS:1e3,DEITY_PASS_BPS:8e3,WHALE_BUNDLE_SMALL_BPS:1e3,WHALE_BUNDLE_LARGE_BPS:4e3};class Je{state;constructor(n=BigInt(Date.now())){this.state=[n,n^BigInt("0xdeadbeefcafebabe")];for(let e=0;e<20;e++)this.next()}next(){let n=this.state[0];const e=this.state[1];return this.state[0]=e,n^=n<<23n,n^=n>>17n,n^=e,n^=e>>26n,this.state[1]=n,this.state[0]+this.state[1]&(1n<<64n)-1n}nextInRange(n){return Number(this.next()%BigInt(n))}nextFloat(){return Number(this.next()%(1n<<53n))/Number(1n<<53n)}}let Qe=new Je;function M(t){return Qe.nextInRange(t)}function Ze(t){const n=t%$t;let e=0;for(let s=0;s<it.length;s++)if(e+=it[s],n<e)return s;return 7}function Xt(){return Ze(M($t))}function nt(t){return{quadrant:t,color:Xt(),symbol:Xt()}}function ct(t=!0){const n=[nt(0),nt(1),nt(2),nt(3)];let e;if(t)e=1+M(3);else{const s=M(100);s===0?e=De:s===1?e=qe:s===2?e=He:e=le}return{traits:n,special:e}}function Q(t,n){let e=0;for(let s=0;s<4;s++)t.traits[s].color===n.traits[s].color&&e++,t.traits[s].symbol===n.traits[s].symbol&&e++;return e}function de(t,n){return t!==le&&t===n}function tn(){return{levelStreak:0,mintCount:0,questStreak:0,affiliateBonus:0,trophyCount:0,hasDeityPass:!1,whaleBundleType:"none"}}function Mt(t){let n=0;return n+=Math.min(t.levelStreak,I.LEVEL_STREAK_MAX)*I.LEVEL_STREAK_BPS,n+=Math.min(t.mintCount,I.MINT_COUNT_MAX)*I.MINT_COUNT_BPS,n+=Math.min(t.questStreak,I.QUEST_STREAK_MAX)*I.QUEST_STREAK_BPS,n+=t.affiliateBonus*I.AFFILIATE_BPS,n+=Math.min(t.trophyCount,I.TROPHY_MAX)*I.TROPHY_BPS,t.hasDeityPass&&(n+=I.DEITY_PASS_BPS),t.whaleBundleType==="small"?n+=I.WHALE_BUNDLE_SMALL_BPS:t.whaleBundleType==="large"&&(n+=I.WHALE_BUNDLE_LARGE_BPS),n}function me(t,n){let e;if(t<=v.MIN_SCORE)e=$.MIN;else if(t<=v.MID_SCORE){const s=t/v.MID_SCORE,o=s*s;e=$.MIN+Math.floor(($.MID-$.MIN)*o)}else if(t<=v.HIGH_SCORE){const s=(t-v.MID_SCORE)/(v.HIGH_SCORE-v.MID_SCORE);e=$.MID+Math.floor(($.HIGH-$.MID)*s)}else if(t<=v.MAX_SCORE){const s=(t-v.HIGH_SCORE)/(v.MAX_SCORE-v.HIGH_SCORE);e=$.HIGH+Math.floor(($.MAX-$.HIGH)*s)}else e=$.MAX;return e}function Lt(t){if(t<=v.MIN_SCORE)return ht;if(t>=v.MAX_SCORE)return Gt;const n=t/v.MAX_SCORE;return ht+Math.floor((Gt-ht)*n)}function en(t){return(t/100).toFixed(2)+"%"}function Vt(t,n,e=!1){const s=J[n]??"",o=e?0:2;return`${t.toLocaleString(void 0,{minimumFractionDigits:o,maximumFractionDigits:o})} ${s}`.trim()}function gt(t,n=!1){if(!Number.isFinite(t))return"n/a";const e=n?0:2;return`x${t.toLocaleString(void 0,{minimumFractionDigits:e,maximumFractionDigits:e})}`}function nn(t,n){const e=t.reduce((o,[a])=>Math.max(o,a.length),0),s=t.map(([o,a])=>`${o.padEnd(e," ")} | ${a}`);if(n&&s.length>=2){const o=s.reduce((i,c)=>Math.max(i,c.length),0),a="-".repeat(o);s.splice(s.length-1,0,a)}return s.join(`
`)}function jt(t,n){return t<5?0:t===8?n?9:8:t}function Kt(t,n){let e=0;return t===5?e=Ge:t===6?e=Xe:t===7?e=Ve:t===8?e=je:t===9&&(e=Ke),e===0?0:Math.floor(n*e/We)}const on=11519315870917187500n;function sn(t){const n=[];for(const a of t.traits)n.push(it[a.color]),n.push(it[a.symbol]);let e=[1n];for(const a of n){const i=BigInt(a),c=BigInt($t)-i,l=Array(e.length+1).fill(0n);for(let r=0;r<e.length;r++){const u=e[r];u!==0n&&(l[r]+=u*c,l[r+1]+=u*i)}e=l}const s=e[0]*BigInt(bt)+e[1]*BigInt(bt)+e[2]*(189n*99n+500n)+e[3]*(500n*99n+1778n)+e[4]*(1778n*99n+6667n)+e[5]*(6667n*99n+31111n)+e[6]*(31111n*99n+155556n)+e[7]*(155556n*99n+355556n)+e[8]*(355556n*99n+BigInt(ue));if(s===0n)return 1;const o=on*10000n/s;return Number(o)/1e4}function fe(t,n,e,s,o,a,i=0){const c=Q(t,n),l=de(t.special,n.special);let r,u=!1;if(c===8&&l)r=ue,u=!0;else if(l){const g=Math.min(c+1,8);r=Math.max(Wt[g],bt)}else r=Wt[c];let d=s;if(o===kt&&i>s){const g=jt(c,l);if(g!==0){const C=i-s,F=Kt(g,C);d=s+F}}else if(o===Fe){const g=jt(c,l);if(g!==0){const C=Kt(g,Ue);d=s+C}}let m=e*r*d/(100*1e4);const f=sn(t);m=m*f,i===0&&(m=m*Ye/ze);const p=d/1e4,w=r/100,E=m<=0,b=l?"Special":`${c} ${c===1?"match":"matches"}`,R=Math.abs(m)>=100,_=[[Vt(e,o,R),"Bet"],[gt(w,R),b]];E||_.push([gt(p,R),"Activity score"],[gt(f,R),"Difficulty"],[Vt(m,o,R),"Payout"]);const S=nn(_,!E);return{matches:c,specialMatch:l,payoutMultiplierBps:r,payout:m,playerTicket:t,resultTicket:n,isJackpot:u,math:S}}function an(t,n){const e={0:.01,1:500,2:0,3:20};return n===2?!1:t>=e[n]}const pe=1,he=2,ge=3,_t=4,cn=[{chance:1,multiplier:4.6},{chance:4,multiplier:2.3},{chance:20,multiplier:1.1},{chance:45,multiplier:.651},{chance:30,multiplier:.45}],Yt=[{chance:795,ppmPerEth:10,tier:"small"},{chance:150,ppmPerEth:390,tier:"medium"},{chance:50,ppmPerEth:800,tier:"large"},{chance:5,ppmPerEth:8e3,tier:"mega"}],ot={low:{baseBps:3e3,stepBps:250},high:{baseBps:15525,stepBps:5e3}},zt=1e6;function rn(t,n){const e=M(20);return e<=10?ln(t,n,e):e<=12?un(t,e):e<=14?dn(e):mn(t,n,e)}let Jt=1;function ln(t,n,e){const s=t*.1272,o=M(100);let a=0,i=.45,c="small";for(const p of cn)if(a+=p.chance,o<a){i=p.multiplier,p.multiplier>=4?c="mega":p.multiplier>=2?c="large":p.multiplier>=1?c="medium":c="small";break}const l=s*i,r=.01*(1+Jt*.05),u=Math.max(1,Math.floor(l/r)),d=Jt+1,m=u*r,f=[`lootboxValue = ${t.toFixed(6)} ETH`,`mainRoll = ${e} (0-10 => tickets)`,`budget = lootboxValue * 0.1272 = ${s.toFixed(6)}`,`varianceRoll = ${o} => multiplier ${i}`,`ticketValue = budget * multiplier = ${l.toFixed(6)}`,`ticketPrice = 0.01 * (1 + level*0.05) = ${r.toFixed(6)}`,`ticketCount = floor(ticketValue / ticketPrice) = ${u}`,`ethValue = ticketCount * ticketPrice = ${m.toFixed(6)}`].join(`
`);return{type:pe,amount:u,description:`${u} ticket${u>1?"s":""} for Lv.${d} (~${m.toFixed(4)} ETH)`,tier:c,ethValue:m,targetLevel:d,math:f}}function un(t,n){const e=M(1e3);let s=0,o=Yt[0];for(const l of Yt)if(s+=l.chance,e<s){o=l;break}const a=t,i=Math.floor(zt*o.ppmPerEth*a/1e6),c=[`lootboxValue = ${t.toFixed(6)} ETH`,`mainRoll = ${n} (11-12 => DGNRS)`,`tierRoll = ${e} => ${o.tier} (${o.ppmPerEth} ppm/ETH)`,"amount = floor(pool * ppm * bet / 1e6)",`= floor(${zt} * ${o.ppmPerEth} * ${a.toFixed(6)} / 1e6)`,`= ${Math.floor(i).toLocaleString()}`].join(`
`);return{type:he,amount:Math.max(1,i),description:`${i.toLocaleString()} DGNRS`,tier:o.tier,math:c}}function dn(t){const n=["lootboxValue = n/a",`mainRoll = ${t} (13-14 => WWXRP)`,"amount = 1"].join(`
`);return{type:ge,amount:1,description:"1 WWXRP",tier:"small",math:n}}function mn(t,n,e){const s=M(20);let o,a,i;if(s<16){o=ot.low.baseBps,a=ot.low.stepBps;const c=M(16),l=o+a*c,r=t*l/1e4;i=l>5e3?"medium":"small";const u=r*1e3,d=[`lootboxValue = ${t.toFixed(6)} ETH`,`mainRoll = ${e} (15-19 => BURNIE)`,`pathRoll = ${s} (low)`,`stepRoll = ${c}`,`multiplierBps = ${l}`,`amountETH = bet * multiplierBps / 10000 = ${r.toFixed(6)}`,`burnie = amountETH * 1000 = ${Math.floor(u)}`].join(`
`);return{type:_t,amount:Math.floor(u),description:`${Math.floor(u).toLocaleString()} BURNIE`,tier:i,math:d}}else{o=ot.high.baseBps,a=ot.high.stepBps;const c=M(4),l=o+a*c,r=t*l/1e4;i=l>25e3?"mega":"large";const u=r*1e3,d=[`lootboxValue = ${t.toFixed(6)} ETH`,`mainRoll = ${e} (15-19 => BURNIE)`,`pathRoll = ${s} (high)`,`stepRoll = ${c}`,`multiplierBps = ${l}`,`amountETH = bet * multiplierBps / 10000 = ${r.toFixed(6)}`,`burnie = amountETH * 1000 = ${Math.floor(u)}`].join(`
`);return{type:_t,amount:Math.floor(u),description:`${Math.floor(u).toLocaleString()} BURNIE`,tier:i,math:d}}}function fn(){return{balance:{0:10,1:1e5,2:1e4,3:1e3},activity:tn(),totalBets:0,totalWins:0,biggestWin:0}}function pn(t,n){const e=t.amountPerTicket*t.ticketCount;if(n.balance[t.currency]<e)return null;n.balance[t.currency]-=e,n.totalBets++,n.activity.affiliateBonus=Math.min(n.activity.affiliateBonus+1,100);const s=Mt(n.activity),o=me(s,t.currency);return hn(t,n,o,e,s)}function hn(t,n,e,s,o){if(t.ticketCount!==1||t.ticket.special<1||t.ticket.special>3)return null;const a=[];let i=0,c=0,l=!1;const r=t.currency===kt?Lt(o):0;for(let p=0;p<t.ticketCount;p++){const w=t.ticket,E=ct(!1),b=fe(w,E,t.amountPerTicket,e,t.currency,o,r);a.push(b),i+=b.payout,b.isJackpot&&(l=!0),b.matches<=1&&an(t.amountPerTicket,t.currency)&&c++}const u=i-s;let d=null,m=0,f;if(t.currency===0&&u>0){m=u*.75;const p=s+u*.25;f=p,n.balance[t.currency]+=p,d=rn(m,t.currency),gn(n,d)}else n.balance[t.currency]+=i;return n.balance[3]+=c,u>0&&(n.totalWins++,u>n.biggestWin&&(n.biggestWin=u)),{mode:1,results:a,totalBet:s,totalPayout:i,netResult:u,consolationPrize:c,hasJackpot:l,lootboxPrize:d,currency:t.currency,amountPerTicket:t.amountPerTicket,ticketCount:t.ticketCount,lootboxValue:m>0?m:void 0,ethPayout:f}}function gn(t,n){switch(n.type){case pe:t.balance[0]+=n.amount*.01;break;case he:t.balance[2]+=n.amount;break;case ge:t.balance[3]+=n.amount;break;case _t:t.balance[1]+=n.amount;break}}function yn(t,n){const e=J[n];return n===0?t.toFixed(4)+" "+e:t.toLocaleString(void 0,{maximumFractionDigits:2})+" "+e}const ye={enabled:!0,volume:.3};let y=null;const St={};let Qt=!1;const Zt={match1:"/sounds/match1.mp3",match2:"/sounds/match2.mp3",match3:"/sounds/match3.mp3",match4:"/sounds/match4.mp3",match5:"/sounds/match5.mp3",match6:"/sounds/match6.mp3",match7:"/sounds/match7.mp3",match8:"/sounds/match8.mp3",win:"/sounds/win.mp3",lose:"/sounds/lose.mp3",click:"/sounds/click.mp3"},U=[262,294,330,349,392,440,494,523];function N(t,n=.15,e="square"){if(y)try{y.state==="suspended"&&y.resume();const s=y.createOscillator(),o=y.createGain();s.type=e,s.frequency.value=t,o.gain.value=ye.volume*.3,o.gain.exponentialRampToValueAtTime(.001,y.currentTime+n),s.connect(o),o.connect(y.destination),s.start(),s.stop(y.currentTime+n)}catch{}}function En(t){if(y)try{if(y.state==="suspended"&&y.resume(),St[t]){const e=y.createBufferSource(),s=y.createGain();e.buffer=St[t],s.gain.value=ye.volume,e.connect(s),s.connect(y.destination),e.start(0);return}const n=t.match(/^match(\d)$/);if(n){const e=parseInt(n[1],10)-1;e>=0&&e<U.length&&N(U[e],.2,"square");return}t==="win"?[0,2,4,7].forEach((e,s)=>{setTimeout(()=>{N(U[e]*2,.2,"square"),s===3&&setTimeout(()=>{N(U[0]*2,.4,"square"),N(U[2]*2,.4,"square"),N(U[4]*2,.4,"square")},100)},s*100)}):t==="lose"?(N(300,.15,"sawtooth"),setTimeout(()=>N(200,.3,"sawtooth"),150)):t==="click"&&N(400,.05,"triangle")}catch{}}async function te(t,n){if(y)try{const e=await fetch(n);if(!e.ok)return;const s=await e.arrayBuffer();St[t]=await y.decodeAudioData(s)}catch{}}function Ee(){if(!Qt){Qt=!0;try{y=new(window.AudioContext||window.webkitAudioContext);const t=window.requestIdleCallback;typeof t=="function"?t(()=>{Object.entries(Zt).forEach(([n,e])=>{te(n,e)})},{timeout:3e3}):setTimeout(()=>{Object.entries(Zt).forEach(([n,e])=>{te(n,e)})},50),console.debug("[degen] Audio initialized")}catch(t){console.debug("[degen] Audio not available:",t)}}}function bn(){const t=()=>{Ee(),document.removeEventListener("click",t),document.removeEventListener("keydown",t)};document.addEventListener("click",t,{passive:!0}),document.addEventListener("keydown",t,{passive:!0})}const _n={chunkSize:6,chunkDelayMs:80};function Sn(){const t=[],n=["pink","purple","green","red","blue","orange","silver","gold"],e={crypto:["xrp","tron","sui","monero","solana","chainlink","ethereum","bitcoin"],zodiac:["aries","taurus","gemini","cancer","leo","libra","sagittarius","aquarius"],cards:["club","diamond","heart","spade","horseshoe","cashsack","king","ace"],dice:["1","2","3","4","5","6","7","8"]},s=[3,4,5,6,0,2,1,7];for(const[o,a]of Object.entries(e))a.forEach((i,c)=>{const l=o==="cards"?s[c]:c;n.forEach(r=>{t.push(`/badges-circular/${o}_0${l}_${i}_${r}.svg`)})});return["special_eth","special_burnie","special_burnie_static","special_dgnrs","special_none"].forEach(o=>{t.push(`/specials/${o}.svg`)}),t}async function vt(){const t=Sn(),{chunkSize:n,chunkDelayMs:e}=_n;let s=0;for(let o=0;o<t.length;o+=n)t.slice(o,o+n).forEach(i=>{const c=new Image;c.decoding="async","fetchPriority"in c&&(c.fetchPriority="low"),c.src=i,c.onload=()=>{s++}}),await new Promise(i=>setTimeout(i,e));console.debug(`[degen] Preloaded ${s}/${t.length} badges`)}function vn(){const t=()=>{const n=window.requestIdleCallback;typeof n=="function"?n(()=>vt(),{timeout:2e3}):setTimeout(vt,50)};document.readyState==="complete"?t():window.addEventListener("load",t,{once:!0})}let rt=fn(),B=null,lt=null;const Pt=kt,wn=256,ee="degenerette_spin_speed",Rn=1.5;let wt=1,L=null,xt=!1,k=!1,Z=null;const X="https://api.degener.us";let P=null;const Rt="degenerette_referrer_code",Cn=Array.from({length:8},(t,n)=>n),Tn=[0,1,2,3,4,5,6,7];function In(){return{traits:[{quadrant:0,color:0,symbol:0},{quadrant:1,color:0,symbol:0},{quadrant:2,color:0,symbol:0},{quadrant:3,color:0,symbol:0}],special:1}}let h=In();const K=[];let ut=null,Ct=[],Tt=[];const be=t=>document.getElementById(t);function $n(t){return t.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"&#10;")}function Bn(t){return t?` data-tooltip="${$n(t)}"`:""}function _e(t){const n=t.results[t.results.length-1];return n?.math?n.math:""}function kn(t){if(!t.lootboxPrize)return;const n=[];return t.currency===0&&t.netResult>0&&t.lootboxValue&&n.push(`${yn(t.lootboxValue,t.currency)} | lootbox value`),n.push(`${t.lootboxPrize.description} | lootbox prize`),n.join(`
`)}function Mn(){try{const t=localStorage.getItem(Rt);return t?t.toUpperCase():null}catch{return null}}function Se(t){try{if(!t){localStorage.removeItem(Rt);return}localStorage.setItem(Rt,t.toUpperCase())}catch{}}function O(t="",n=""){const e=document.getElementById("referral-status");e&&(e.textContent=t,e.classList.remove("status-success","status-error","status-pending"),n&&e.classList.add(`status-${n}`))}function Ln(){const t=new URLSearchParams(window.location.search),n=t.get("ref")||t.get("referral")||t.get("code");if(!n)return;const e=n.trim().toUpperCase();e&&Se(e),t.delete("ref"),t.delete("referral"),t.delete("code");const s=t.toString(),o=`${window.location.pathname}${s?`?${s}`:""}${window.location.hash}`;window.history.replaceState({},"",o)}function Pn(){Ln(),h=ct(),h.special=1+Math.floor(Math.random()*3),Nt(),z(),Vn(),Xn(),Nn(),Dn(),qn(),Un(),xn(),Dt(),qt(),On(),At(),Ot(),bn(),vn()}function xn(){const t=document.getElementById("randomize-btn");t&&t.addEventListener("click",()=>{Ht()})}function Nn(){const t=document.getElementById("spin-speed"),n=document.getElementById("spin-speed-value");if(!t||!n)return;const e=s=>{wt=Number.isFinite(s)?s:1;const o=wt/Rn;n.textContent=`${o.toFixed(1)}x`};try{const s=localStorage.getItem(ee),o=s?parseFloat(s):NaN;Number.isFinite(o)?(t.value=o.toFixed(1),e(o)):e(parseFloat(t.value))}catch{e(parseFloat(t.value))}t.addEventListener("input",()=>{const s=parseFloat(t.value);e(s);try{localStorage.setItem(ee,s.toFixed(1))}catch{}})}function An(){return!!document.getElementById("rerand-on-spin")?.checked}async function G(t,n={}){const e=await fetch(`${X}${t}`,{...n,credentials:"include",headers:{"Content-Type":"application/json",...n.headers||{}}});if(!e.ok){const s=await e.text();let o="Request failed";try{o=JSON.parse(s).error||o}catch{o=s||o}throw new Error(o)}return e.status===204?null:e.json()}function Y(t){B=t,lt=t.activity_score_bps??0,L=t.eth_address??null,Nt(),z(),at(),H(),At(),Ot(),t?.referrer_code&&Se(null)}async function On(){try{const t=await G("/api/player");Y(t.player)}catch{}}function Dn(){const t=document.getElementById("wallet-connect-btn");t&&(t.addEventListener("click",async()=>{if(t.disabled)return;const n=t.querySelector(".btn-text"),e=n?.textContent??t.textContent;if(L){try{await G("/api/wallet/logout",{method:"POST"})}catch{}L=null,B=null,lt=null,at();return}const s=window.ethereum;if(!s){alert("No Ethereum wallet detected.");return}try{t.disabled=!0,n?n.textContent="Connecting...":t.textContent="Connecting...";const a=(await s.request({method:"eth_requestAccounts"}))?.[0];if(!a)return;const i=await G("/api/wallet/nonce",{method:"POST",body:JSON.stringify({address:a})}),c=await s.request({method:"personal_sign",params:[i.message,a]}),l=Mn(),r=await G("/api/wallet/verify",{method:"POST",body:JSON.stringify({address:a,signature:c,referrerCode:l})});Y(r.player)}catch(o){console.warn("Wallet connection rejected",o);let a="Wallet connection failed. Please try again.";if(o instanceof Error)a=o.message;else if(o&&typeof o=="object"&&"message"in o){const i=o.message;typeof i=="string"&&(a=i)}alert(a),at()}finally{t.disabled=!1,n?n.textContent=e||"Connect Wallet":t.textContent=e||"Connect Wallet"}}),at())}function at(){const t=document.getElementById("wallet-connect-btn");if(!t)return;const n=t.querySelector(".btn-text");if(!L){n?n.textContent="Connect Wallet":t.textContent="Connect Wallet",H();return}const e=`${L.slice(0,6)}...${L.slice(-4)}`;n?n.textContent=e:t.textContent=e,H()}function qn(){const t=document.getElementById("discord-connect-btn");t&&(t.addEventListener("click",async()=>{if(P){await Fn();return}window.location.href=`${X}/auth/discord`}),Hn())}async function Hn(){try{const t=await fetch(`${X}/auth/discord/me`,{credentials:"include"});if(!t.ok)throw new Error("Not connected");P=(await t.json())?.user??null}catch{P=null}ve()}async function Fn(){try{await fetch(`${X}/auth/discord/logout`,{method:"POST",credentials:"include"})}catch{}P=null,ve()}function ve(){const t=document.getElementById("discord-connect-btn");if(!t)return;const n=t.querySelector(".btn-text");if(!P){n?n.textContent="Discord":t.textContent="Discord",H();return}n?n.textContent=P.username:t.textContent=P.username,H()}function Un(){const t=document.getElementById("referral-create-btn"),n=document.getElementById("referral-copy-btn");t&&t.addEventListener("click",async()=>{const e=document.getElementById("referral-code-input");if(!e)return;if(!L||!P){O("Connect wallet + Discord","error");return}const s=e.value.trim().toUpperCase();if(!s||!/^[A-Z0-9]{3,12}$/.test(s)){O("3-12 letters or numbers","error");return}const o=document.getElementById("rakeback-select"),a=o?parseInt(o.value,10):0;try{t.disabled=!0,O("Saving...","pending");const i=await G("/api/affiliate/config",{method:"POST",body:JSON.stringify({code:s,rakebackBps:a})});B&&i.player&&(B.referral_code=i.player.referral_code,B.referral_locked=1),H(),O("Saved!","success"),window.setTimeout(()=>O(""),1600)}catch(i){console.error("Referral create failed",i);const c=i?.message||"Unable to create referral code. Please try again.";O(c,"error")}finally{t.disabled=!1}}),n&&n.addEventListener("click",async()=>{const e=B?.referral_code;if(e){const s=`${window.location.origin}${window.location.pathname}?ref=${e}`;try{await navigator.clipboard.writeText(s),n.textContent="Copied!",window.setTimeout(()=>{n.textContent="Copy Link"},1200)}catch{}}}),H()}function H(){const t=document.getElementById("referral-row"),n=document.getElementById("referral-create"),e=document.getElementById("referral-display"),s=document.getElementById("referral-code-value"),o=document.getElementById("referral-code-input");if(!t)return;const a=!!(L&&P);if(t.classList.toggle("hidden",!a),!a){O("");return}const i=B?.referral_code,c=!!B?.referral_locked;i&&c?(n?.classList.add("hidden"),e?.classList.remove("hidden"),s&&(s.textContent=i),O("")):(n?.classList.remove("hidden"),e?.classList.add("hidden"),o&&!o.value&&(o.placeholder="Choose referral code or default"))}function Nt(){const t=document.getElementById("currency-balance");if(!t)return;const n=B?B.balance_wwxrp:rt.balance[Pt],e=Math.floor(n);t.textContent=e.toLocaleString(void 0,{maximumFractionDigits:0})}function Wn(){const t=document.getElementById("leaderboard-list");if(!t)return;if(!Ct.length){t.innerHTML='<p class="placeholder">No leaderboard data yet</p>';return}const n=Ct.map((e,s)=>{const o=e.eth_address?`${e.eth_address.slice(0,6)}...${e.eth_address.slice(-4)}`:"Unknown",a=e.discord_name||o,i=e.discord_avatar?`<img class="leaderboard-avatar" src="${e.discord_avatar}" alt="${a}" />`:'<div class="leaderboard-avatar"></div>',c=Math.floor(e.balance_wwxrp).toLocaleString(void 0,{maximumFractionDigits:0});return`
      <div class="leaderboard-item">
        <div class="leaderboard-rank">#${s+1}</div>
        <div class="leaderboard-user">
          ${i}
          <span class="leaderboard-name" title="${a}">${a}</span>
        </div>
        <div class="leaderboard-balance">${c}</div>
      </div>
    `}).join("");t.innerHTML=n}function ne(t){if(!t)return null;try{const n=JSON.parse(t);return!n||!Array.isArray(n.traits)?null:n}catch{return null}}function Gn(){const t=document.getElementById("biggest-wins-list");if(!t)return;if(!Tt.length){t.innerHTML='<p class="placeholder">No wins yet</p>';return}const n=Tt.map(e=>{const s=e.eth_address?`${e.eth_address.slice(0,6)}...${e.eth_address.slice(-4)}`:"Unknown",o=e.discord_name||s,a=e.discord_avatar?`<img src="${e.discord_avatar}" alt="${o}" />`:'<div class="leaderboard-avatar"></div>',i=Math.max(0,Math.round(e.bet_amount||0)),c=Math.max(0,Math.round(e.payout||0)),l=i>0?Math.max(1,Math.round(c/i)):0,r=i.toLocaleString(void 0,{maximumFractionDigits:0}),u=c.toLocaleString(void 0,{maximumFractionDigits:0}),d=r.length>9?"num-xlong":r.length>6?"num-long":"",m=u.length>9?"num-xlong":u.length>6?"num-long":"",f=`x${l}`,p=f.length>7?"num-long":"",w=ne(e.player_ticket),E=ne(e.house_ticket),b="win",R=w?x(w,"small",E??void 0,!1,b,!0,!1):tt("small"),_=E?x(E,"small",w??void 0,!1,b,!0,!0):tt("small");return`
      <div class="history-item win biggest-win-item">
        <div class="biggest-win-compare">
          <div class="mini-col">
            <div class="biggest-win-user">
              ${a}
              <span class="biggest-win-name" title="${o}">${o}</span>
            </div>
            ${R}
          </div>
          <div class="biggest-win-metrics">
            <div class="biggest-win-metric bet ${d}">${r}</div>
            <div class="biggest-win-metric multiplier ${p}">${f}</div>
            <div class="biggest-win-metric paid ${m}">${u}</div>
          </div>
          <div class="mini-col">
            <div class="biggest-win-spacer"></div>
            ${_}
          </div>
        </div>
      </div>
    `}).join("");t.innerHTML=n}async function At(){try{const t=await fetch(`${X}/api/leaderboard?limit=10`,{credentials:"include"});if(!t.ok)throw new Error("Failed to load leaderboard");const n=await t.json();Ct=Array.isArray(n?.leaderboard)?n.leaderboard:[],Wn()}catch(t){console.warn("Leaderboard fetch failed",t)}}async function Ot(){try{const t=await fetch(`${X}/api/biggest-wins?limit=5`,{credentials:"include"});if(!t.ok)throw new Error("Failed to load biggest wins");const n=await t.json();Tt=Array.isArray(n?.wins)?n.wins:[],Gn()}catch(t){console.warn("Biggest wins fetch failed",t)}}function st(){Nt()}function dt(t,n){const s=Math.abs(t)>=100?0:n===0?4:1;return t.toLocaleString(void 0,{maximumFractionDigits:s})}function z(){const t=lt??Mt(rt.activity),n=Lt(t),e=document.getElementById("activity-score");e&&(e.textContent=`${Math.floor(t/100)}%`,e.setAttribute("data-tooltip",`ROI: ${en(n)}`))}function Xn(){const t=document.getElementById("spin-full");t?.addEventListener("click",ie),t?.addEventListener("dblclick",e=>{e.preventDefault(),xt?Re():(k=!0,ie())});const n=document.getElementById("ft-amount");n?.addEventListener("change",()=>{const e=parseFloat(n.value);if(!Number.isFinite(e))return;const s=Math.max(1,Math.round(e));n.value=s.toString()})}let T=null,W=null;function Vn(){const t=document.getElementById("ft-player");t&&(t.addEventListener("click",n=>{const e=n.target,s=e.closest(".gamepiece-special-container");if(s){oe("specials",void 0,s);return}const o=e.closest(".gp-quadrant");if(!o||!o.dataset.quadrant)return;const a=parseInt(o.dataset.quadrant,10);oe("quadrant",a,o)}),t.addEventListener("wheel",n=>{const s=n.target.closest(".gp-quadrant");if(!s||!s.dataset.quadrant)return;n.preventDefault();const o=parseInt(s.dataset.quadrant,10),a=s.getBoundingClientRect(),i=n.clientX-a.left-a.width/2,c=n.clientY-a.top-a.height/2,r=Math.hypot(i,c)/(a.width/2),u=n.deltaY>0?1:-1;if(r>=.55){const d=(h.traits[o].color+u+8)%8;h.traits[o].quadrant=o,h.traits[o].color=d}else{const d=(h.traits[o].symbol+u+8)%8;h.traits[o].quadrant=o,h.traits[o].symbol=d}q(),It()},{passive:!1}),document.addEventListener("click",n=>{const e=document.getElementById("quick-selector");if(!e||e.classList.contains("hidden"))return;const s=n.target;e.contains(s)||W&&W.contains(s)||It()}),window.addEventListener("resize",()=>{T&&W&&we(W)}))}function q(){ut=null,Dt(),qt()}function oe(t,n,e){const s=document.getElementById("quick-selector");if(s){if(T={mode:t,quadrant:n},W=e,s.className=`quick-selector ${t}`,t==="quadrant"&&n!==void 0){const o=ce[n],a=Ne[o],i=h.traits[n].color,c=Tn.map(r=>{const u=Bt[r];return`
        <button data-type="color" data-color="${r}" title="${Pe[r]}">
          <span class="color-swatch" style="background: var(--color-${u});"></span>
        </button>
      `}).join(""),l=Cn.map(r=>{const u=a[r],d=re(n,r,i);return`
        <button data-type="symbol" data-symbol="${r}" title="${u}">
          <span class="symbol-swatch"><img src="${d}" alt="${u}" /></span>
        </button>
      `}).join("");s.innerHTML=`${c}${l}`}else if(t==="specials"){const o=[1,2,3];s.innerHTML=o.map(a=>{const i=Qn(a);return`
        <button data-special="${a}" title="${Et[a]}">
          <span class="symbol-swatch"><img src="${i}" alt="${Et[a]}" /></span>
        </button>
      `}).join("")}s.classList.remove("hidden"),we(e),s.querySelectorAll("button").forEach(o=>{o.addEventListener("click",()=>{if(T){if(T.mode==="quadrant"&&T.quadrant!==void 0){const a=o.dataset.type;if(a==="color"){const i=parseInt(o.dataset.color||"0",10);h.traits[T.quadrant].quadrant=T.quadrant,h.traits[T.quadrant].color=i,q()}else if(a==="symbol"){const i=parseInt(o.dataset.symbol||"0",10);h.traits[T.quadrant].quadrant=T.quadrant,h.traits[T.quadrant].symbol=i,q()}}else if(T.mode==="specials"){const a=parseInt(o.dataset.special||"0",10);h.special=a,q()}It()}})})}}function It(){const t=document.getElementById("quick-selector");t&&(t.classList.add("hidden"),T=null,W=null)}function we(t){const n=document.getElementById("quick-selector");if(!n)return;const e=t.getBoundingClientRect(),s=12,o=window.scrollX||window.pageXOffset,a=window.scrollY||window.pageYOffset;let i=e.left+o,c=e.bottom+a+8;const l=o+window.innerWidth-n.offsetWidth-s;i>l&&(i=Math.max(s+o,l));const r=a+window.innerHeight-n.offsetHeight-s;c>r&&(c=e.top+a-n.offsetHeight-8),n.style.left=`${i}px`,n.style.top=`${c}px`}function Dt(){const t=document.getElementById("ft-player"),n=document.getElementById("ft-house");if(!t||!n)return;const e=ut;if(e&&e.results?.length){const s=e.results[e.results.length-1],o=typeof e.netResult=="number"?e.netResult:0,a=o>0?"win":o<0?"loss":"neutral";t.innerHTML=x(s.playerTicket,"hero",s.resultTicket,!0,a,!0,!1),n.innerHTML=x(s.resultTicket,"hero",s.playerTicket,!1,a,!0,!0)}else t.innerHTML=x(h,"hero",void 0,!0),n.innerHTML=tt("hero")}function qt(){const t=document.getElementById("net-result-value"),n=document.getElementById("net-result-box"),e=document.getElementById("net-result-token-value"),s=document.getElementById("net-result-token-unit");if(!t)return;const o=ut;if(!o){t.textContent="—",e&&s&&(e.textContent="—",s.textContent=J[Pt],e.classList.remove("positive","negative")),n?.classList.remove("has-tooltip"),n?.removeAttribute("data-tooltip");return}o.netResult;const a=o.results[o.results.length-1];let i="—",c=0;if(a&&(a.specialMatch?i="Special":typeof a.matches=="number"?i=`${a.matches}`:a.playerTicket&&a.resultTicket&&(i=`${Q(a.playerTicket,a.resultTicket)}`),a.specialMatch?c=8:typeof a.matches=="number"?c=a.matches:a.playerTicket&&a.resultTicket&&(c=Q(a.playerTicket,a.resultTicket))),t.textContent=i,t.classList.remove("positive","negative"),e&&s){let r=0;if(o.currency===0){const f=o.ethPayout;r=(typeof f=="number"?f:o.totalPayout)-o.totalBet}else r=o.netResult??0;const u=r>0?"+":r<0?"-":"",d=dt(Math.abs(r),o.currency),m=J[o.currency]??"Token";e.textContent=`${u}${d}`,s.textContent=m,e.classList.toggle("positive",r>0),e.classList.toggle("negative",r<0);for(let f=1;f<=8;f+=1)e.classList.remove(`win-tier-${f}`);if(r>0){const f=Math.min(8,Math.max(1,c<=1?1:c));e.classList.add(`win-tier-${f}`)}}const l=_e(o);n&&l&&(n.classList.add("has-tooltip"),n.setAttribute("data-tooltip",l))}function jn(t,n,e,s){const o=document.getElementById("net-result-value"),a=document.getElementById("net-result-box"),i=document.getElementById("net-result-token-value"),c=document.getElementById("net-result-token-unit");if(o){if(o.textContent=n?"Special":`${t}`,o.classList.remove("positive","negative"),i&&c){const l=e>0?"+":e<0?"-":"",r=dt(Math.abs(e),s);i.textContent=`${l}${r}`,c.textContent=J[s],i.classList.toggle("positive",e>0),i.classList.toggle("negative",e<0)}a?.classList.remove("has-tooltip"),a?.removeAttribute("data-tooltip")}}function Re(){k=!0,Z&&Z()}function Kn(t){return k||t<=0?Promise.resolve():new Promise(n=>{let e=!1;const s=()=>{e||(e=!0,Z=null,n())},o=window.setTimeout(s,t);Z=()=>{window.clearTimeout(o),s()}})}function Yn(t,n,e,s,o){const a=Bt.length;return{traits:t.traits.map((i,c)=>{const l=n.traits[c],r=e.has(c)?i.color:(l.color+1)%a,u=s.has(c)?i.symbol:(l.symbol+1)%a;return{...i,quadrant:c,color:r,symbol:u}}),special:o?t.special:0}}function yt(t,n,e,s,o,a,i){if(!n)return;const c=lt??Mt(rt.activity),l=me(c),r=Lt(c),u=Yn(t,n,e,s,o),d=fe(n,u,a,l,i,c,r),m=d.payout-a;jn(d.matches,d.specialMatch,m,i)}function zn(t,n,e){const s=document.getElementById("roll-pop");if(!s||!Number.isFinite(t))return;if(typeof e=="number"&&Number.isFinite(e)){const i=Math.max(1,e/100),c=.9+Math.log10(i)*.6,l=Math.max(.85,Math.min(2.4,c));s.style.setProperty("--pop-scale",l.toFixed(2))}else s.style.removeProperty("--pop-scale");const o=dt(t,n),a=t>0?`+${o}`:o;s.textContent=a,s.classList.remove("positive","negative","neutral"),s.classList.add(t>0?"positive":t<0?"negative":"neutral"),s.classList.remove("roll-pop--show"),s.offsetWidth,s.classList.add("roll-pop--show")}function Jn(t){const n=document.querySelector("#ft-player .gamepiece-result"),e=document.querySelector("#ft-house .gamepiece-result"),s=Math.min(16,4+t*2),o=Math.min(9,2+t*.8);[n,e].forEach(a=>{a&&(a.style.setProperty("--jiggle-amp",`${s}px`),a.style.setProperty("--jiggle-rot",`${o}deg`),a.classList.remove("token-jiggle"),a.offsetWidth,a.classList.add("token-jiggle"))})}function Ce(t){switch(t){case 1:return"/specials/special_eth.svg";case 2:return"/specials/special_burnie.svg";case 3:return"/specials/special_dgnrs.svg";default:return"/specials/special_none.svg"}}function Qn(t){return t===2?"/specials/special_burnie_static.svg":Ce(t)}function A(t){xt=t;const n=document.getElementById("spin-full");n&&(n.textContent=t?"SKIP":"SPIN",n.disabled=!1)}function Zn(t,n,e,s){const o=ct(),a=o.traits.map((i,c)=>{const l={...i,quadrant:c};return n.has(c)&&(l.color=t.traits[c].color),e.has(c)&&(l.symbol=t.traits[c].symbol),l});return o.traits=a,o.special=s?t.special:0,o}function se(t,n,e,s){return{traits:t.traits.map((o,a)=>({...o,color:n.has(a)?o.color:-1,symbol:e.has(a)?o.symbol:-1})),special:s?t.special:-1}}async function ae(t,n,e,s){const o=document.getElementById("ft-house");if(!o)return;const a=Math.max(80,wn/wt),i=()=>2+Math.floor(Math.random()*3),c=new Set,l=new Set;let r=!1;const u=n&&Number.isFinite(e)&&typeof s=="number",d=()=>{const _=Zn(t,c,l,r),S=n?se(t,c,l,r):void 0,g=n?se(n,c,l,r):void 0;if(o.innerHTML=x(_,"hero",g),n){const C=document.getElementById("ft-player");C&&(C.innerHTML=x(n,"hero",S,!0))}},m=()=>{Z=null,c.add(0),c.add(1),c.add(2),c.add(3),l.add(0),l.add(1),l.add(2),l.add(3),r=!0,d(),u&&yt(t,n,c,l,r,e,s)},f=window.__DEGEN__;let p=0;const w=[0,1,2,3],E=8;let b=0,R=i();for(;b<E;){if(k){k=!1,m();return}let _=null;if(R>0)R-=1;else{const S=[];for(const g of w)c.has(g)?l.has(g)||S.push({quadrant:g,type:"symbol"}):S.push({quadrant:g,type:"color"});if(S.length){const g=S[Math.floor(Math.random()*S.length)],C=g.quadrant,F=g.type==="color";F?c.add(C):l.add(C),b+=1,R=i(),_={quadrant:C,isColorPhase:F}}else break}if(d(),u&&yt(t,n,c,l,r,e,s),_&&n&&f){const S=n.traits[_.quadrant],g=t.traits[_.quadrant];(_.isColorPhase?S.color===g.color:S.symbol===g.symbol)?(p++,f.playSound?.(`match${p}`),p>=3&&Jn(p-2)):f.playSound?.("click")}if(k){k=!1,m();return}await Kn(a)}r=!0,d(),u&&yt(t,n,c,l,r,e,s)}function ie(){if(xt){Re();return}An()?Ht():q();const t=Pt,n=be("ft-amount"),e=parseFloat(n.value),s=Number.isFinite(e)?Math.max(1,Math.round(e)):NaN;if(isNaN(s)||s<=0){alert("Invalid bet amount");return}if(n.value=s.toString(),!L||!B){const a=pn({ticket:h,ticketCount:1,currency:t,amountPerTicket:s},rt);if(!a){alert("Insufficient balance!");return}const i=a.results[a.results.length-1]?.resultTicket;if(!i){st(),D(a);return}const c=k;if(k=!1,c){st(),z(),D(a);return}A(!0),ae(i,h,s,t).then(()=>{st(),z(),D(a),A(!1)}).catch(()=>{st(),z(),D(a),A(!1)});return}A(!0),G("/api/spin",{method:"POST",body:JSON.stringify({ticket:h,amount:s,currency:t})}).then(async o=>{const a=o.result.results[o.result.results.length-1]?.resultTicket;if(!a){Y(o.player),D(o.result),A(!1);return}const i=k;if(k=!1,i){Y(o.player),D(o.result),A(!1);return}await ae(a,h,s,t),Y(o.player),D(o.result),A(!1)}).catch(o=>{console.error("Spin failed",o);let a="Spin failed. Please try again.";if(o?.message)try{const i=JSON.parse(o.message);i?.error&&(a=i.error)}catch{a=o.message}alert(a),A(!1)})}function x(t,n="small",e,s=!1,o,a,i){const c=n==="mini"?34:n==="small"?52:n==="medium"?70:n==="large"?110:160,l=c*2,r=n==="hero",u=t.traits.map((V,mt)=>{const Be=re(V.quadrant,V.symbol,V.color);let j="";if(e){const et=e.traits[mt],ft=et.color>=0,pt=et.symbol>=0,Ft=ft&&V.color===et.color,Ut=pt&&V.symbol===et.symbol;Ft&&Ut?j="q-both-match":Ft||Ut?j="q-partial-match":ft&&pt?j="q-no-match":(ft||pt)&&(j="q-unknown-loss")}const ke=s?"interactive":"",Me=r?"gamepiece-badge hero-badge":"gamepiece-badge",Le=r?"":` style="width:${c}px;height:${c}px;"`;return`<div class="gp-quadrant ${j} ${ke}" data-quadrant="${mt}"><img src="${Be}" class="${Me}" data-q="${mt}"${Le} /></div>`}).join(""),d=t.special>0,m=e&&d&&t.special===e.special,f=!!(a&&e),p=o&&!f?`result-${o}`:"",E=f&&!m&&!(f&&!m&&i&&d),b=f&&!m&&(o==="win"||o==="loss")?`center-bg-${o}`:"",R=E&&o?o==="win"?"flame-win":`flame-${o}`:"",_=[m?"special-match":"",p,b,R].filter(Boolean).join(" "),S=E?"/specials/special_none.svg":Ce(t.special),g=E?"Flame":d?Et[t.special]:"Flame",C=`<img src="${S}" alt="${g}" class="gamepiece-special-icon" />`,F=`<div class="gamepiece-special-container ${_}">${C}</div>`,Te=s?'data-interactive="true"':"",Ie=r?" gamepiece-hero":"",$e=r?"":` style="width:${l}px;height:${l}px;"`;return`<div class="gamepiece-result${Ie}" ${Te}${$e}>${u}${F}</div>`}function tt(t="small"){const e=(t==="mini"?34:t==="small"?52:t==="medium"?70:t==="large"?110:160)*2,s=t==="hero",o=Array.from({length:4},()=>'<div class="gp-quadrant empty"></div>').join(""),a=s?" gamepiece-hero":"",i=s?"":` style="width:${e}px;height:${e}px;"`;return`
    <div class="gamepiece-result is-empty${a}"${i}>
      ${o}
      <div class="gamepiece-special-container"></div>
    </div>
  `}function to(t){const n=_e(t),e=kn(t),s=e?`${n}
---
${e}`:n,o=t.results[t.results.length-1],a={currency:t.currency,totalBet:t.totalBet,totalPayout:t.totalPayout,netResult:t.netResult,tooltip:s,timestamp:Date.now()};o&&(a.playerTicket=o.playerTicket,a.resultTicket=o.resultTicket),K.unshift(a),K.length>50&&K.pop(),eo()}function eo(){const t=be("results-container");if(K.length===0){t.innerHTML='<p class="placeholder">No history yet</p>';return}const n=K.map((e,s)=>{const o=e.netResult>=0,a=e.netResult>0?"win":e.netResult<0?"loss":"neutral",i=(e.netResult>=0?"+":"")+dt(e.netResult,e.currency),c=e.tooltip??"";let l="—",r="Matches: —",u=0;if(e.playerTicket&&e.resultTicket){const p=de(e.playerTicket.special,e.resultTicket.special),w=Q(e.playerTicket,e.resultTicket);u=p?8:w,l=p?"Special":`${w}`,r=p?"Special":`Matches: ${l}`}const d=e.netResult>0?Math.min(8,Math.max(1,u<=1?1:u)):null,m=d?`win-tier-${d}`:"",f=`
      <div class="history-compare">
        <div class="mini-col">
          <span class="mini-label you-label">You</span>
          ${e.playerTicket?x(e.playerTicket,"small",e.resultTicket,!1,a,!0,!1):tt("small")}
        </div>
        <div class="history-net-big ${o?"positive":"negative"} ${m} has-tooltip"${Bn(c)}>${i}</div>
        <div class="mini-col">
          <span class="mini-label matches-label">${r}</span>
          ${e.resultTicket?x(e.resultTicket,"small",e.playerTicket,!1,a,!0,!0):tt("small")}
        </div>
      </div>
    `;return`
      <div class="history-item ${o?"win":"loss"}">
        ${f}
      </div>
    `}).join("");t.innerHTML=`<div class="history-list">${n}</div>`}function D(t){ut=t,to(t),Dt(),qt();const e=t.results[t.results.length-1]?.payoutMultiplierBps;zn(t.netResult??0,t.currency,e),At(),Ot();const s=window.__DEGEN__;if(s){const o=t.results[t.results.length-1];if(o){const a=typeof o.matches=="number"?o.matches:o.playerTicket&&o.resultTicket?Q(o.playerTicket,o.resultTicket):0,i=o.specialMatch,c=t.netResult>0;setTimeout(()=>{i||a>=6||c||a>=3?s.playSound?.("win"):s.playSound?.("lose")},200)}}}function Ht(){h=ct(),h.special=1+Math.floor(Math.random()*3),q()}window.__DEGEN__=window.__DEGEN__||{};window.__DEGEN__.randomize=Ht;window.__DEGEN__.getCurrentTicket=()=>h;window.__DEGEN__.setTicket=t=>{h=t,q()};window.__DEGEN__.playSound=En;window.__DEGEN__.initAudio=Ee;window.__DEGEN__.preloadBadges=vt;Pn();
